<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Compiled and minified JQuery -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <!-- Compiled Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Font Awesome CDN -->
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="CSS/style.css" />
    <title>CovidLive</title>
    <style type="text/css">
    #form1 .label-icon i {
        margin-top: 50%;
        transform: translateY(-25%);
    }

    #form1 .input-field {
        height: 55px;
        top: 50%;
        transform: translateY(-50%);
    }

    a {
        color: #000;
    }
    </style>
</head>

<body style="display: flex;flex-direction: column;height: 100vh;">
    <div id="navigation">
        <nav>
            <div class="nav-wrapper header">
                <a href="/home" class="brand-logo">
                    <span>CovidLive</span>
                </a>
                <a href="#" data-target="mobile-demo" class="sidenav-trigger"><i class="material-icons">menu</i></a>
            </div>
            <nav style="z-index: 2" class=" nav-wrapper header hide-on-large-only no-shadows" id="mobile-search-bar">
                <form id="form2" class="show-on-med-and-down">
                    <div class="input-field">
                        <input id="search-mobile" type="search" required placeholder="Search Country" title="Search for Products" onblur="clearText()">
                        <label class="label-icon" for="search"><i class="material-icons">search</i></label>
                        <i class="material-icons">close</i>
                        <div id="searchResults"></div>
                    </div>
                </form>
            </nav>
            <ul class="sidenav header" id="mobile-demo">
                <li class="accent" style="padding-top: 10px;">
                    <div class="container" style="font-size:18px">
                        <i style="font-size: 48px;margin:0" class="large material-icons row">account_box</i>
                        <div style="width: 100%" class="waves-effect row">
                            <span class="col s10">Hello, user</span><span style="padding-top: 10px;" class="col s1 material-icons">arrow_forward</span>
                        </div>
                    </div>
                </li>
                <li><a href="/home" class="waves-effect waves-accent icon-white">Home<i class="material-icons icon-white">home</i></a></li>
                <li><a href="/categories" class="waves-effect waves-accent icon-white">Categories<i class="material-icons icon-white">format_list_bulleted</i></a></li>
                <li><a href="/cart" class="waves-effect waves-accent icon-white">Cart<i class="material-icons icon-white">shopping_cart</i>
                        <span class="cart-value-text cart-value hide right" style="top:50%;transform:translateY(-50%);right: 10%;border-radius: 5px">5</span>
                    </a>
                </li>
                <hr>
                <li><a href="/contact" class="waves-effect waves-accent icon-white">Contact Us<i class="material-icons icon-white">email</i></a></li>
                <li><a href="/login" class="waves-effect waves-accent icon-white">FAQs<i class="material-icons icon-white">question_answer</i></a></li>
            </ul>
            <div class="fixed-action-btn horizontal hide-on-large-only">
                <a class="btn-floating btn-large accent waves-effect waves-light">
                    <i class="large material-icons">live_help</i>
                </a>
                <div class="cart-value-text cart-value hide">5</div>
                <ul>
                    <li><a href="/checkout" class="btn-floating red " title="Check Out"><i class="material-icons">call</i></a></li>
                    <li><a href="/cart" class="btn-floating yellow darken-1" title="View Cart"><i class="material-icons">info</i></a></li>
                </ul>
            </div>
    </div>
    <main style="flex-grow: 1;overflow: auto;position: relative;">
        <div id="content" style="flex-grow: 1;">
            <div class="hide-on-large-only" style="margin:18px 0;padding: 10px">
            </div>
            <div class="container-fluid">
                <ul class="collection" id="countries">
                </ul>
            </div>
        </div>
        <div style="position: absolute;top: 50%;left: 50%;transform:translate(-50%,-50%);">
            <div class="preloader-wrapper big active">
                <div class="spinner-layer spinner-blue-only">
                    <div class="circle-clipper left">
                        <div class="circle"></div>
                    </div>
                    <div class="gap-patch">
                        <div class="circle"></div>
                    </div>
                    <div class="circle-clipper right">
                        <div class="circle"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <script>
    $(document).ready(function() {
        $('.sidenav').sidenav();
        $('.fixed-action-btn').floatingActionButton();
        showCountryData();
    });

    function showCountryData() {
        let country = location.search.slice(1);
        country = country.split("&");
        let status = true
        fetch(`https://covidapi.info/api/v1/country/${country[0]}`)
            .then(d => {
                if (d.status != 200)
                    throw new Error("Not found");
                else
                    return d.json()
            })
            .then(e => e != undefined ? showData(e) : 0)
            .catch(r => {
                findFurther(country[1]);
            })
    }

    function findFurther(c) {
        if (!localStorage[c]) {
            let data;
            fetch(`https://corona.lmao.ninja/countries/${c}`)
                .then(d => d.json())
                .then(e => {
                    localStorage[c] = JSON.stringify(e);
                    printData(e);
                })
        } else
            printData(JSON.parse(localStorage[c]));
    }

    function printData(data) {
        document.write(JSON.stringify(data));
    }

    function showData(data) {
        document.write("<h1>Original</h1>");
        document.write(JSON.stringify(data));
    }

    function clearText() {
        localStorage.clear();
    }
    </script>
</body>

</html>